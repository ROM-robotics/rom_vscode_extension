"use strict";var L=Object.create;var w=Object.defineProperty;var _=Object.getOwnPropertyDescriptor;var R=Object.getOwnPropertyNames;var T=Object.getPrototypeOf,k=Object.prototype.hasOwnProperty;var H=(e,s)=>{for(var c in s)w(e,c,{get:s[c],enumerable:!0})},S=(e,s,c,m)=>{if(s&&typeof s=="object"||typeof s=="function")for(let r of R(s))!k.call(e,r)&&r!==c&&w(e,r,{get:()=>s[r],enumerable:!(m=_(s,r))||m.enumerable});return e};var C=(e,s,c)=>(c=e!=null?L(T(e)):{},S(s||!e||!e.__esModule?w(c,"default",{value:e,enumerable:!0}):c,e)),I=e=>S(w({},"__esModule",{value:!0}),e);var G={};H(G,{activate:()=>B,deactivate:()=>E});module.exports=I(G);var o=C(require("vscode")),$=require("child_process"),h=C(require("fs"));function B(e){console.log("Robot Code Sync extension is now active!");let s=o.window.createStatusBarItem(o.StatusBarAlignment.Right,100);s.command="robot-code-sync.syncToRobot",s.text="$(cloud-upload) Sync to Robot",s.tooltip="Click to sync code to robot",o.workspace.getConfiguration("robotCodeSync").get("showStatusBar",!0)&&s.show(),e.subscriptions.push(s);let m=o.commands.registerCommand("robot-code-sync.syncToRobot",async()=>{let a=o.workspace.getConfiguration("robotCodeSync"),t=a.get("sourcePath","/home/mr_robot/Desktop/Git/rom_robotics/rom_nav2_ws"),d=a.get("destinationPath","/home/mr_robot/Desktop/Git/rom_robotics/rom_nav2_ws"),i=a.get("robotHost","robot@192.168.1.100"),g=a.get("robotPassword",""),x=a.get("excludePatterns",[".git","node_modules"]);if(!h.existsSync(t)){let p=await o.window.showInputBox({prompt:"Source path does not exist. Enter valid source path:",value:t,validateInput:b=>h.existsSync(b)?null:"Path does not exist"});if(!p)return;t=p,await a.update("sourcePath",t,o.ConfigurationTarget.Global)}if(await o.window.showInformationMessage(`Sync from:
${t}

To:
${i}:${d}`,"Yes","No")!=="Yes")return;t.endsWith("/")||(t+="/");let f=x.map(p=>`--exclude='${p}'`).join(" "),l;g?l=`sshpass -p '${g}' rsync -avz --delete ${f} "${t}" ${i}:"${d}"`:l=`rsync -avz --delete ${f} "${t}" ${i}:"${d}"`,o.window.withProgress({location:o.ProgressLocation.Notification,title:"Syncing to robot...",cancellable:!1},async p=>new Promise((b,P)=>{(0,$.exec)(l,(u,v,y)=>{if(u){o.window.showErrorMessage(`Sync failed: ${u.message}`);let n=o.window.createOutputChannel("Robot Code Sync");n.appendLine("Error:"),n.appendLine(u.message),y&&(n.appendLine(`
Stderr:`),n.appendLine(y)),n.appendLine(`
Command:`),n.appendLine(l.replace(g,"***")),n.show(),P(u);return}if(o.window.showInformationMessage("\u2705 Code synced to robot successfully!"),v){let n=o.window.createOutputChannel("Robot Code Sync");n.appendLine("Sync completed:"),n.appendLine(v)}b()})}))}),r=o.commands.registerCommand("robot-code-sync.openSSH",async()=>{let a=o.workspace.getConfiguration("robotCodeSync"),t=a.get("robotHost","robot@192.168.1.100"),d=a.get("robotPassword",""),i=o.window.createTerminal({name:`SSH: ${t}`,shellPath:"/bin/bash"});d?i.sendText(`sshpass -p '${d}' ssh ${t}`):i.sendText(`ssh ${t}`),i.show()});e.subscriptions.push(m),e.subscriptions.push(r)}function E(){}0&&(module.exports={activate,deactivate});
